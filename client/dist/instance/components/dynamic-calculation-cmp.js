"use strict";function CreateDynamicCalculation(e,t,a){var c=function(){function c(e,a,c){var r=this;this._calculateService=a,this._instanceService=c,this.output={status:"default",message:"",outputs:t.outputs};for(var i={},n=0,u=Object.keys(t.template.inputs);n<u.length;n++){var o=u[n],s=[t.inputs[o]||t.template.inputs[o]["default"]];t.template.inputs[o].required&&s.push(common_1.Validators.required),i[o]=s}this.scratchpadForm=e.group(i),this.scratchpadForm.valueChanges.debounceTime(400).distinctUntilChanged().subscribe(function(){return r.calculate()})}return c.prototype.ngOnInit=function(){},c.prototype.calculate=function(){var e=this;if(this.scratchpadForm.valid){for(var a={},c=0,r=Object.keys(t.template.inputs);c<r.length;c++){var i=r[c];a[i]=parseInt(this.scratchpadForm.value[i])}this._calculateService.calculate(a,t.template.calculation).subscribe(function(t){e.output.outputs=t.outputs,e.output.status=t.status,e.output.message=JSON.stringify(t.values)}),this._instanceService.saveInstance(t._id,{inputs:this.scratchpadForm.value,outputs:this.output.outputs}).subscribe()}},c=__decorate([core_1.Component({selector:"dynamic-calculation",directives:a,providers:[common_1.FORM_PROVIDERS,calculation_service_1.CalculationService],pipes:[round_1["default"]],template:e}),__param(0,core_1.Inject(common_1.FormBuilder)),__param(1,core_1.Inject(calculation_service_1.CalculationService)),__param(2,core_1.Inject(instance_service_1.InstanceService)),__metadata("design:paramtypes",[common_1.FormBuilder,calculation_service_1.CalculationService,instance_service_1.InstanceService])],c)}();return c}var __decorate=this&&this.__decorate||function(e,t,a,c){var r,i=arguments.length,n=3>i?t:null===c?c=Object.getOwnPropertyDescriptor(t,a):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,c);else for(var u=e.length-1;u>=0;u--)(r=e[u])&&(n=(3>i?r(n):i>3?r(t,a,n):r(t,a))||n);return i>3&&n&&Object.defineProperty(t,a,n),n},__metadata=this&&this.__metadata||function(e,t){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(e,t):void 0},__param=this&&this.__param||function(e,t){return function(a,c){t(a,c,e)}},core_1=require("@angular/core"),common_1=require("@angular/common"),round_1=require("../pipes/round"),calculation_service_1=require("../../calculation/services/calculation-service"),instance_service_1=require("../../calculation/services/instance-service");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=CreateDynamicCalculation;